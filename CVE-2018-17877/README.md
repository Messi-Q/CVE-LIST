
# CVE-2018-17877

## Vendor


## Vulnerability Type
Bad Randomness

## Abstract
We found a vulnerability in smart contract of `-------` which is an Ethereum lottery implementation. This contract generates a random value that is predictable via an external contract call. The developer used the extcodesize() function to prevent a malicious contract from being called, but the attacker can bypass it by writing the core code in the constructor of their exploit code. Therefore, it allows attackers to always win and get rewards.


## Details
`--------` is a Ethereum gambling game. 


In this contract, the developer used a mitigation that does not allow a contract to access their contract. (Line 115,116). Here, the developer demanded extcodesize of msg.sender to be 0. Extcodesize(A) assembly function returns the size of the code at address A. If the extcodesize of address A is not 0, it is likely to be a contract address, since the contract address will contain the code area. However, when a contract is deployed in the blockchain, the blockchain first put the constructor and initialize code size as 0. So if the attacker calculate the random number in constructor, they can easily bypass this logic.


## Exploit


## Conclusion
Most of gambling and lottery smart contracts which internally have their own pseudo random number generator might have a Bad Randomness vulnerability. This is because the information in the block chain is transparent and the variables that make up the random number can be accessed and calculated through the contract.

## Reference


## Discoverer
Team Code4Block
